{% extends "master.html" %}


{% block titulo %}Estamos en un buscador{% endblock %}


{% block contenido %}

<h3>Buscador del paralelo {{paralelo.nombre}}</h3>
<hr/>

<div class="row">
    <div class="col-md-4">
      <input type="hidden" id="id_paralelo" value="{{paralelo.id_paralelo}}">
        <label for="seleccionador">Seleccione la inicial del apellido</label>
        <select id="seleccionador" class="form-control">
    
        {% for v,t in abecedario %}
            <option value="{{v}}">{{t}}</option>
        {% endfor %}
    </select>
    </div>
</div>
<hr />

<div class="row">
    <div class="col-md-8">
        <div id="cargar_datos">
        </div>
    </div>
</div>
<script type="text/javascript">
    jQuery(document).ready(function ($) {
        console.log('llegando');
        $('#seleccionador').click(function(){
                    $valor = $('#seleccionador').val();
                    $id_paralelo = $('#id_paralelo').val();
                    console.log($valor);
                    console.log($id_paralelo);
                    $.ajax({
                        method:"post",
                        url: '{% url "academico.views.funcion_ajax_buscador" %}',
                        data: {
                            'valor': $valor,
                            'id_paralelo': $id_paralelo,
                        },
                        //beforeSend:function() {},
                        success:function(data){
                            console.log('regresando del m√©todo');
                            console.log(data.mensaje);
                            var obj = jQuery.parseJSON(data.estudiantes);
                            var cadena_html = "<div>";
                            cadena0 = "<ul>";
                            cadena_ciclo = "";
                            for(i=0; i<obj.length; i++){
                                console.log(obj[i]);
                                cadena1 = "<li>"+obj[i].nombre+" - ";
                                cadena2 = obj[i].apellido+"</li>";
                                cadena_ciclo = cadena_ciclo + cadena1 + cadena2
                                console.log("------------------");
                            } 
                            
                            cadena3 = "</ul></hr>";
                            cadena_html = cadena_html + cadena0 + cadena_ciclo + cadena3; 
                            cadena_html = cadena_html + "</div>";; 
                            $('#cargar_datos').html(cadena_html);
                        }
                    });
                });

    });
</script> 
{% endblock %}
